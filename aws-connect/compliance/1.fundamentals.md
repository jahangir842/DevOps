# üîê **Security & Compliance Fundamentals**

### 1. **IAM (Identity and Access Management)**

IAM controls *who can do what* in AWS.

* **Why it matters here**:

  * Agents, supervisors, developers, and CI/CD pipelines need different permissions.
  * Customer data in Amazon Connect (CTRs, call recordings) must be tightly controlled.

* **Best Practices**:

  * **Least privilege** ‚Üí Example: An agent role should only access Connect & recordings, not S3 buckets directly.
  * **IAM roles** over long-term keys ‚Üí Example: A Lambda that queries DynamoDB for IVR should assume a role.
  * **Permission boundaries** for dev/test vs prod environments.

* **Example**:

  ```yaml
  # IAM policy for Lambda that reads CTR data
  {
    "Version": "2012-10-17",
    "Statement": [
      {
        "Effect": "Allow",
        "Action": ["connect:GetContactAttributes"],
        "Resource": "*"
      },
      {
        "Effect": "Allow",
        "Action": ["dynamodb:GetItem"],
        "Resource": "arn:aws:dynamodb:us-east-1:123456789012:table/CustomerProfiles"
      }
    ]
  }
  ```

---

### 2. **KMS (Key Management Service)**

KMS handles encryption keys for data at rest and in transit.

* **Where used in Amazon Connect**:

  * Encrypt **call recordings** in S3.
  * Encrypt **CTR data** in DynamoDB or Redshift.
  * Encrypt secrets for Lambda functions (API keys for CRMs like Salesforce).

* **Best Practices**:

  * Use **customer-managed CMKs** (not just AWS-managed).
  * Enable **automatic rotation** of keys.
  * Use **encryption context** (helps with compliance audits).

* **Example**:

  * Store call recordings in S3 with KMS encryption:

    ```bash
    aws s3api put-bucket-encryption \
      --bucket my-connect-recordings \
      --server-side-encryption-configuration '{
        "Rules": [
          {
            "ApplyServerSideEncryptionByDefault": {
              "SSEAlgorithm": "aws:kms",
              "KMSMasterKeyID": "arn:aws:kms:us-east-1:123456789012:key/abcd-efgh-1234"
            }
          }
        ]
      }'
    ```

---

### 3. **GDPR (General Data Protection Regulation ‚Äì EU)**

Applies if you‚Äôre handling EU citizens‚Äô data.

* **Why important**: Contact centers collect *personal data* (names, numbers, call recordings).

* **Key requirements**:

  * **Right to be forgotten** ‚Üí Must delete recordings or CTRs upon request.
  * **Data minimization** ‚Üí Don‚Äôt store more than needed.
  * **Data residency** ‚Üí Keep EU customer data in EU regions (Frankfurt, Ireland).

* **Example**:

  * Build a Lambda function that deletes call recordings for a customer when requested:

    ```python
    import boto3
    s3 = boto3.client('s3')
    def handler(event, context):
        customer_id = event['customer_id']
        bucket = "my-connect-recordings"
        prefix = f"customers/{customer_id}/"
        objects = s3.list_objects_v2(Bucket=bucket, Prefix=prefix)
        for obj in objects.get('Contents', []):
            s3.delete_object(Bucket=bucket, Key=obj['Key'])
    ```

---

### 4. **PCI DSS (Payment Card Industry ‚Äì Data Security Standard)**

Applies if you‚Äôre handling payments via IVR.

* **Why important**: Contact centers often take **credit card payments** over the phone.

* **Key requirements**:

  * Don‚Äôt store card numbers in CTRs or logs.
  * Use **pause-and-resume** recording during sensitive info collection.
  * Ensure **TLS 1.2+** for all traffic.

* **Example in Amazon Connect**:

  * Use **Amazon Connect agent whisper flow** that pauses call recording when customer enters card details ‚Üí sends details directly to payment gateway (like Stripe or PayPal).

---

### 5. **HIPAA (Health Insurance Portability and Accountability Act ‚Äì US)**

Applies if you‚Äôre handling patient health data.

* **Why important**: Healthcare call centers (appointments, test results, prescriptions).

* **Key requirements**:

  * Use **HIPAA-eligible AWS services** (Amazon Connect is HIPAA eligible).
  * Encrypt **PHI** (Protected Health Information) with KMS.
  * Sign a **BAA (Business Associate Agreement)** with AWS.

* **Example**:

  * Store call transcripts (via Amazon Transcribe) in an encrypted S3 bucket with **restricted IAM roles**.
  * Only allow medical supervisors with MFA to access those transcripts.

---

# ‚úÖ Putting It All Together (Job Context)

In your **Amazon Connect solution design**:

* **IAM** ‚Üí control access for agents, supervisors, Lambdas.
* **KMS** ‚Üí encrypt recordings, CTRs, CRM API credentials.
* **GDPR** ‚Üí ensure deletion, regional storage, minimal retention.
* **PCI** ‚Üí secure payment IVR flows, prevent storing card details.
* **HIPAA** ‚Üí use HIPAA-eligible services, encrypt PHI, sign BAA.

---

üìå **Interview-style Example Question**:
*"How would you make sure Amazon Connect is PCI compliant when taking payments?"*

‚úÖ Answer:

* Use **dual-tone multi-frequency (DTMF) masking** so agents can‚Äôt hear card numbers.
* **Pause call recording** when customer enters payment details.
* Store no card data in CTRs or logs.
* Ensure data is encrypted with **KMS keys**.
* Restrict IAM roles so only payment processor Lambda can handle the request.

---

